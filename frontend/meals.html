<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browse Meals - ChopNow</title>
    <meta name="description" content="Discover amazing discounted meals from local vendors. Fresh food at unbeatable prices.">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü•ó</text></svg>">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <a href="index.html" class="logo">
                    <div class="logo-icon">ü•ó</div>
                    <span>ChopNow</span>
                </a>
                
                <ul class="nav-menu" id="navMenu">
                    <li><a href="index.html" class="nav-link">Home</a></li>
                    <li><a href="meals.html" class="nav-link active">Browse Meals</a></li>
                    <li><a href="index.html#how-it-works" class="nav-link">How it Works</a></li>
                    <li><a href="index.html#about" class="nav-link">About</a></li>
                </ul>
                
                <div class="nav-actions">
                    <div class="auth-buttons" id="authButtons">
                        <a href="login.html" class="btn btn-ghost">Sign In</a>
                        <a href="register.html" class="btn btn-primary">Get Started</a>
                    </div>
                    
                    <div class="user-menu" id="userMenu" style="display: none;">
                        <a href="cart.html" class="btn btn-ghost">
                            <i class="fas fa-shopping-cart"></i>
                            Cart <span class="cart-count" id="cartCount">0</span>
                        </a>
                        <button class="btn btn-ghost" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i>
                            Logout
                        </button>
                    </div>
                    
                    <button class="mobile-menu-toggle" id="mobileMenuToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Search Hero -->
    <section style="background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)); padding: var(--space-20) 0; color: white;">
        <div class="container">
            <div class="text-center">
                <h1 style="font-size: 2.75rem; font-weight: 900; margin-bottom: var(--space-4); text-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    Discover Amazing Deals
                </h1>
                <p style="font-size: 1.25rem; margin-bottom: var(--space-10); opacity: 0.95; max-width: 600px; margin-left: auto; margin-right: auto; line-height: 1.6;">
                    Fresh meals at discounted prices from local vendors near you
                </p>
                
                <!-- Search Bar -->
                <div class="location-input" style="max-width: 700px; margin: 0 auto;">
                    <input 
                        type="text" 
                        id="searchInput" 
                        placeholder="Search for meals, restaurants, or cuisines..." 
                        style="flex: 1; border: none; outline: none; padding: var(--space-4) var(--space-6); font-size: 1rem; color: var(--gray-900); font-weight: 500;"
                    >
                    <button onclick="searchMeals()" class="location-btn">
                        <i class="fas fa-search"></i>
                        Search
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Filters & Results -->
    <section style="padding: var(--space-12) 0;">
        <div class="container">
            <!-- Quick Filters -->
            <div class="quick-filters" style="margin-bottom: var(--space-10);">
                <div class="flex gap-3 flex-wrap">
                    <button class="filter-chip active" onclick="setQuickFilter('all')" data-filter="all">
                        <i class="fas fa-utensils"></i>
                        All Meals
                    </button>
                    <button class="filter-chip" onclick="setQuickFilter('discount')" data-filter="discount">
                        <i class="fas fa-fire"></i>
                        Best Deals
                    </button>
                    <button class="filter-chip" onclick="setQuickFilter('nearby')" data-filter="nearby">
                        <i class="fas fa-map-marker-alt"></i>
                        Nearby
                    </button>
                    <button class="filter-chip" onclick="setQuickFilter('fast')" data-filter="fast">
                        <i class="fas fa-bolt"></i>
                        Quick Pickup
                    </button>
                    <button class="filter-chip" onclick="setQuickFilter('new')" data-filter="new">
                        <i class="fas fa-sparkles"></i>
                        New Today
                    </button>
                </div>
            </div>

            <div class="meals-layout" style="display: grid; grid-template-columns: 320px 1fr; gap: var(--space-10);">
                <!-- Advanced Filters Sidebar -->
                <div class="filters-sidebar">
                    <div class="card">
                        <div class="card-body">
                            <h3 style="font-size: 1.25rem; font-weight: 800; margin-bottom: var(--space-6); color: var(--gray-900); display: flex; align-items: center; gap: var(--space-3);">
                                <i class="fas fa-filter" style="color: var(--primary-color);"></i>
                                Filters
                            </h3>
                            
                            <!-- Cuisine Type -->
                            <div class="filter-group" style="margin-bottom: var(--space-8);">
                                <h4 style="font-size: 1rem; font-weight: 700; margin-bottom: var(--space-4); color: var(--gray-800);">Cuisine Type</h4>
                                <div class="filter-options">
                                    <label class="filter-option">
                                        <input type="checkbox" name="cuisine" value="african" onchange="applyFilters()">
                                        <span>üçõ African</span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" name="cuisine" value="asian" onchange="applyFilters()">
                                        <span>üçú Asian</span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" name="cuisine" value="american" onchange="applyFilters()">
                                        <span>üçî American</span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" name="cuisine" value="indian" onchange="applyFilters()">
                                        <span>üçõ Indian</span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" name="cuisine" value="mediterranean" onchange="applyFilters()">
                                        <span>ü•ô Mediterranean</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Price Range -->
                            <div class="filter-group" style="margin-bottom: var(--space-8);">
                                <h4 style="font-size: 1rem; font-weight: 700; margin-bottom: var(--space-4); color: var(--gray-800);">Price Range</h4>
                                <div class="price-range">
                                    <div style="display: flex; gap: var(--space-3); margin-bottom: var(--space-3);">
                                        <input type="range" id="priceMin" min="0" max="5000" value="0" oninput="updatePriceRange()" style="flex: 1;">
                                        <input type="range" id="priceMax" min="0" max="5000" value="5000" oninput="updatePriceRange()" style="flex: 1;">
                                    </div>
                                    <div class="price-display" style="display: flex; justify-content: space-between; font-size: 0.875rem; color: var(--gray-600); font-weight: 600;">
                                        <span>‚Ç¶<span id="priceMinDisplay">0</span></span>
                                        <span>‚Ç¶<span id="priceMaxDisplay">5000</span></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Dietary Restrictions -->
                            <div class="filter-group" style="margin-bottom: var(--space-8);">
                                <h4 style="font-size: 1rem; font-weight: 700; margin-bottom: var(--space-4); color: var(--gray-800);">Dietary</h4>
                                <div class="filter-options">
                                    <label class="filter-option">
                                        <input type="checkbox" name="dietary" value="vegetarian" onchange="applyFilters()">
                                        <span>üå± Vegetarian</span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" name="dietary" value="vegan" onchange="applyFilters()">
                                        <span>ü•¨ Vegan</span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" name="dietary" value="halal" onchange="applyFilters()">
                                        <span>üïå Halal</span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" name="dietary" value="gluten-free" onchange="applyFilters()">
                                        <span>üåæ Gluten-Free</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Distance -->
                            <div class="filter-group" style="margin-bottom: var(--space-6);">
                                <h4 style="font-size: 1rem; font-weight: 700; margin-bottom: var(--space-4); color: var(--gray-800);">Distance</h4>
                                <select id="distanceFilter" class="form-control" onchange="applyFilters()">
                                    <option value="">Any distance</option>
                                    <option value="1">Within 1 km</option>
                                    <option value="3">Within 3 km</option>
                                    <option value="5">Within 5 km</option>
                                    <option value="10">Within 10 km</option>
                                </select>
                            </div>

                            <button onclick="clearFilters()" class="btn btn-outline w-full">
                                <i class="fas fa-times"></i>
                                Clear All Filters
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Results Area -->
                <div class="results-area">
                    <!-- Results Header -->
                    <div class="results-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-8); flex-wrap: wrap; gap: var(--space-4);">
                        <div>
                            <h2 style="font-size: 1.75rem; font-weight: 800; color: var(--gray-900); margin-bottom: var(--space-2);">
                                <span id="resultsCount">Loading...</span> meals found
                            </h2>
                            <p style="color: var(--gray-600); font-size: 1rem;">Showing the best deals near you</p>
                        </div>
                        
                        <div class="sort-options">
                            <select id="sortSelect" class="form-control" onchange="applySorting()" style="min-width: 200px;">
                                <option value="discount">Best Discount</option>
                                <option value="price-low">Price: Low to High</option>
                                <option value="price-high">Price: High to Low</option>
                                <option value="rating">Highest Rated</option>
                                <option value="distance">Nearest First</option>
                                <option value="newest">Newest First</option>
                            </select>
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div id="loadingState" class="text-center" style="padding: var(--space-20) 0;">
                        <div class="spinner" style="margin: 0 auto var(--space-4);"></div>
                        <p style="color: var(--gray-600); font-size: 1.125rem; font-weight: 500;">Finding the best deals for you...</p>
                    </div>

                    <!-- Meals Grid -->
                    <div id="mealsGrid" class="meals-grid" style="display: none;">
                        <!-- Meals will be loaded here -->
                    </div>

                    <!-- Empty State -->
                    <div id="emptyState" class="text-center" style="padding: var(--space-20) 0; display: none;">
                        <div style="width: 120px; height: 120px; background: var(--gray-100); border-radius: var(--radius-2xl); display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-6); font-size: 3rem; color: var(--gray-400);">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-700); margin-bottom: var(--space-3);">No meals found</h3>
                        <p style="color: var(--gray-600); margin-bottom: var(--space-8); max-width: 400px; margin-left: auto; margin-right: auto; line-height: 1.6;">
                            Try adjusting your filters or search terms to find more options
                        </p>
                        <button onclick="clearFilters()" class="btn btn-primary btn-lg">
                            <i class="fas fa-refresh"></i>
                            Clear Filters
                        </button>
                    </div>

                    <!-- Load More -->
                    <div id="loadMoreContainer" class="text-center" style="margin-top: var(--space-12); display: none;">
                        <button id="loadMoreBtn" onclick="loadMoreMeals()" class="btn btn-outline btn-lg">
                            <i class="fas fa-plus"></i>
                            Load More Meals
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="logo" style="margin-bottom: var(--space-6);">
                        <div class="logo-icon">ü•ó</div>
                        <span>ChopNow</span>
                    </div>
                    <p style="color: var(--gray-400); line-height: 1.6;">
                        Connecting communities to reduce food waste and provide affordable, delicious meals.
                    </p>
                </div>
                
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="meals.html">Browse Meals</a></li>
                        <li><a href="register.html">Sign Up</a></li>
                        <li><a href="register.html?type=vendor">Become a Vendor</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Support</h3>
                    <ul class="footer-links">
                        <li><a href="#help">Help Center</a></li>
                        <li><a href="#contact">Contact Us</a></li>
                        <li><a href="#terms">Terms of Service</a></li>
                        <li><a href="#privacy">Privacy Policy</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 ChopNow. All rights reserved. Made with ‚ù§Ô∏è for a sustainable future.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        let currentPage = 1;
        let currentFilters = {};
        let currentSort = 'discount';
        let allMeals = [];
        let filteredMeals = [];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadMeals();
            setupEventListeners();
            
            // Check for URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('cuisine')) {
                setFilterFromURL('cuisine', urlParams.get('cuisine'));
            }
            if (urlParams.get('location')) {
                document.getElementById('searchInput').value = urlParams.get('location');
            }

            // Mobile menu toggle
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const navMenu = document.getElementById('navMenu');
            
            if (mobileMenuToggle && navMenu) {
                mobileMenuToggle.addEventListener('click', function() {
                    navMenu.classList.toggle('show');
                });
            }

            // Update navigation
            if (window.chopNowApp) {
                window.chopNowApp.updateNavigation();
            }
        });

        function setupEventListeners() {
            // Search input
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchMeals();
                }
            });
        }

        async function loadMeals() {
            try {
                showLoading();
                const meals = await window.chopNowApp.makeRequest('/api/meals');
                allMeals = Array.isArray(meals) ? meals : [];
                filteredMeals = [...allMeals];
                
                applyFilters();
                displayMeals();
                updateResultsCount();
                
            } catch (error) {
                console.error('Error loading meals:', error);
                showEmptyState();
            }
        }

        function displayMeals() {
            const grid = document.getElementById('mealsGrid');
            const loadingState = document.getElementById('loadingState');
            const emptyState = document.getElementById('emptyState');
            
            loadingState.style.display = 'none';
            
            if (filteredMeals.length === 0) {
                grid.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            grid.style.display = 'grid';
            
            grid.innerHTML = filteredMeals.map(meal => `
                <div class="meal-card" onclick="window.location.href='meal-details.html?id=${meal.id}'">
                    <div style="position: relative;">
                        <img src="${meal.image_url || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=400&h=220&fit=crop&crop=center'}" 
                             alt="${meal.name}" class="meal-image">
                        <div class="meal-badge">${Math.round(((meal.original_price - meal.discounted_price) / meal.original_price) * 100)}% OFF</div>
                    </div>
                    <div class="meal-info">
                        <h3 class="meal-name">${meal.name}</h3>
                        <p class="meal-description">${meal.description || 'Fresh and delicious meal available for pickup'}</p>
                        
                        <div style="display: flex; align-items: center; gap: var(--space-2); margin-bottom: var(--space-4); font-size: 0.875rem; color: var(--gray-600);">
                            <i class="fas fa-store" style="color: var(--primary-color);"></i>
                            <span>${meal.vendor_name || 'Local Vendor'}</span>
                        </div>
                        
                        <div class="meal-pricing">
                            <div class="meal-price">
                                <span class="price-current">‚Ç¶${meal.discounted_price}</span>
                                <span class="price-original">‚Ç¶${meal.original_price}</span>
                            </div>
                            <div class="restaurant-rating">
                                <i class="fas fa-star"></i>
                                4.5 (23)
                            </div>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-4); font-size: 0.875rem; color: var(--gray-600);">
                            <span><i class="fas fa-clock" style="color: var(--accent-color);"></i> Ready in 15 min</span>
                            <span><i class="fas fa-fire" style="color: var(--accent-color);"></i> ${meal.quantity_available || 5} left</span>
                        </div>
                        
                        <button class="btn btn-primary w-full" onclick="event.stopPropagation(); addToCart(${meal.id})">
                            <i class="fas fa-plus"></i>
                            Add to Cart
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function showLoading() {
            document.getElementById('loadingState').style.display = 'block';
            document.getElementById('mealsGrid').style.display = 'none';
            document.getElementById('emptyState').style.display = 'none';
        }

        function showEmptyState() {
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('mealsGrid').style.display = 'none';
            document.getElementById('emptyState').style.display = 'block';
        }

        function updateResultsCount() {
            document.getElementById('resultsCount').textContent = filteredMeals.length;
        }

        // Filter Functions
        function setQuickFilter(filter) {
            // Update active filter chip
            document.querySelectorAll('.filter-chip').forEach(chip => {
                chip.classList.remove('active');
            });
            document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
            
            // Apply filter logic
            switch(filter) {
                case 'all':
                    filteredMeals = [...allMeals];
                    break;
                case 'discount':
                    filteredMeals = allMeals.filter(meal => {
                        const discount = ((meal.original_price - meal.discounted_price) / meal.original_price) * 100;
                        return discount >= 30;
                    });
                    break;
                case 'nearby':
                case 'fast':
                    filteredMeals = [...allMeals];
                    break;
                case 'new':
                    filteredMeals = allMeals.filter(meal => {
                        const created = new Date(meal.created_at);
                        const today = new Date();
                        const diffTime = Math.abs(today - created);
                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                        return diffDays <= 1;
                    });
                    break;
            }
            
            applySorting();
            displayMeals();
            updateResultsCount();
        }

        function applyFilters() {
            let filtered = [...allMeals];
            
            // Cuisine filters
            const cuisineFilters = Array.from(document.querySelectorAll('input[name="cuisine"]:checked'))
                .map(input => input.value);
            if (cuisineFilters.length > 0) {
                filtered = filtered.filter(meal => 
                    cuisineFilters.includes(meal.cuisine_type?.toLowerCase())
                );
            }
            
            // Dietary filters
            const dietaryFilters = Array.from(document.querySelectorAll('input[name="dietary"]:checked'))
                .map(input => input.value);
            if (dietaryFilters.length > 0) {
                filtered = filtered.filter(meal => {
                    const restrictions = meal.dietary_restrictions ? JSON.parse(meal.dietary_restrictions) : [];
                    return dietaryFilters.some(diet => restrictions.includes(diet));
                });
            }
            
            // Price range
            const minPrice = parseInt(document.getElementById('priceMin').value);
            const maxPrice = parseInt(document.getElementById('priceMax').value);
            filtered = filtered.filter(meal => 
                meal.discounted_price >= minPrice && meal.discounted_price <= maxPrice
            );
            
            filteredMeals = filtered;
            applySorting();
            displayMeals();
            updateResultsCount();
        }

        function applySorting() {
            const sortBy = document.getElementById('sortSelect').value;
            
            filteredMeals.sort((a, b) => {
                switch(sortBy) {
                    case 'discount':
                        const discountA = ((a.original_price - a.discounted_price) / a.original_price) * 100;
                        const discountB = ((b.original_price - b.discounted_price) / b.original_price) * 100;
                        return discountB - discountA;
                    case 'price-low':
                        return a.discounted_price - b.discounted_price;
                    case 'price-high':
                        return b.discounted_price - a.discounted_price;
                    case 'rating':
                        return (b.rating || 4.5) - (a.rating || 4.5);
                    case 'distance':
                        return (a.distance || 1) - (b.distance || 1);
                    case 'newest':
                        return new Date(b.created_at) - new Date(a.created_at);
                    default:
                        return 0;
                }
            });
        }

        function searchMeals() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            if (!searchTerm.trim()) {
                filteredMeals = [...allMeals];
            } else {
                filteredMeals = allMeals.filter(meal => 
                    meal.name.toLowerCase().includes(searchTerm) ||
                    meal.description?.toLowerCase().includes(searchTerm) ||
                    meal.cuisine_type?.toLowerCase().includes(searchTerm) ||
                    meal.vendor_name?.toLowerCase().includes(searchTerm)
                );
            }
            
            applySorting();
            displayMeals();
            updateResultsCount();
        }

        function updatePriceRange() {
            const minPrice = document.getElementById('priceMin').value;
            const maxPrice = document.getElementById('priceMax').value;
            
            document.getElementById('priceMinDisplay').textContent = minPrice;
            document.getElementById('priceMaxDisplay').textContent = maxPrice;
            
            applyFilters();
        }

        function clearFilters() {
            // Clear all checkboxes
            document.querySelectorAll('input[type="checkbox"]').forEach(input => {
                input.checked = false;
            });
            
            // Reset price range
            document.getElementById('priceMin').value = 0;
            document.getElementById('priceMax').value = 5000;
            updatePriceRange();
            
            // Reset distance
            document.getElementById('distanceFilter').value = '';
            
            // Reset search
            document.getElementById('searchInput').value = '';
            
            // Reset to all meals
            setQuickFilter('all');
        }

        function setFilterFromURL(filterType, value) {
            if (filterType === 'cuisine') {
                const checkbox = document.querySelector(`input[name="cuisine"][value="${value}"]`);
                if (checkbox) {
                    checkbox.checked = true;
                    applyFilters();
                }
            }
        }

        // Add to cart function
        async function addToCart(mealId) {
            const button = event.target.closest('button');
            const originalHTML = button.innerHTML;
            
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Adding...';
            button.disabled = true;
            
            try {
                // Find the meal data
                const meal = allMeals.find(m => m.id === mealId);
                if (!meal) {
                    throw new Error('Meal not found');
                }
                
                if (window.chopNowApp && window.chopNowApp.auth.isLoggedIn()) {
                    // Add to server cart for logged-in users
                    await window.chopNowApp.makeRequest('/api/cart/add', {
                        method: 'POST',
                        body: JSON.stringify({
                            mealId: mealId,
                            quantity: 1
                        })
                    });
                } else {
                    // Add to localStorage for guests
                    const cartItems = JSON.parse(localStorage.getItem('cartItems') || '[]');
                    const existingItem = cartItems.find(item => item.id === mealId);
                    
                    if (existingItem) {
                        existingItem.quantity += 1;
                    } else {
                        cartItems.push({
                            id: meal.id,
                            name: meal.name,
                            discounted_price: meal.discounted_price,
                            original_price: meal.original_price,
                            vendor_name: meal.vendor_name,
                            image_url: meal.image_url,
                            quantity: 1
                        });
                    }
                    
                    localStorage.setItem('cartItems', JSON.stringify(cartItems));
                }
                
                button.innerHTML = '<i class="fas fa-check"></i> Added!';
                button.style.background = 'var(--accent-color)';
                
                // Update cart count
                if (window.chopNowApp) {
                    window.chopNowApp.cart.updateCount();
                }
                
                // Show notification
                if (window.chopNowApp && window.chopNowApp.showNotification) {
                    window.chopNowApp.showNotification('Added to cart successfully!', 'success');
                }
                
            } catch (error) {
                console.error('Error adding to cart:', error);
                button.innerHTML = '<i class="fas fa-exclamation"></i> Error';
                button.style.background = 'var(--error)';
                
                if (window.chopNowApp && window.chopNowApp.showNotification) {
                    window.chopNowApp.showNotification('Failed to add to cart', 'error');
                }
            }
            
            setTimeout(() => {
                button.innerHTML = originalHTML;
                button.style.background = '';
                button.disabled = false;
            }, 2000);
        }

        function loadMoreMeals() {
            // Implementation for pagination
            console.log('Load more meals');
        }

        // Logout function
        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('userType');
            localStorage.removeItem('userId');
            window.location.href = 'login.html';
        }
    </script>
</body>
</html>